## 共识机制
Proof of History (PoH) 是 Solana 区块链的核心创新之一，它为区块链提供了一个去中心化的时间源。PoH 本质上是一个高频可验证延迟函数 (VDF)，它能够创建历史记录，证明某个事件发生在特定时刻之前或之后。  
PoH 的基础是一个高效的哈希函数（通常是 SHA-256），它的计算是连续和不可中断的。即，给定一个初始输入，每次哈希计算都依赖于上一次的输出。 
通过记录每一次哈希的输出和当前的计数器 $n$，可以生成一个链式的时间证明。 
$$
计算公式: ~~ H_0 = seed, ~ H_{n+1} = SHA-256(H_n) \\
结算结果: ~~ H_0 - H_1 - H_2 - H_3 - H_4 - ... - H_n
$$
可以看到PoH 节点生成时间序列的过程完全依赖于 SHA-256 等加密哈希函数，不需要依靠网络通信，因此十分高效。使得 Solana 可以实现 400 毫秒以内的区块生成时间，并支持超过 65,000 TPS（每秒交易数）。  

PoH 节点会不断计算哈希序列 $ H_0 - H_1 - H_2 - H_3 - H_4 - ... - H_n $，从而生成一个线性的时间流。  
为了将交易分配到区块中，PoH 会采取一定的策略（包括固定间隔和动态调整等方式）来确定区块边界，比如：假设一个区块包含 1000 次哈希计算，那么每当 PoH 节点计算到第 1000 个哈希值时，就标记当前区块的结束。  
区块 1 包含 $ H_0 - H_{999} $ 的交易。  
区块 2 包含 $ H_{1000} - H_{1999} $ 的交易。

当 PoH 节点接收到交易时，PoH 节点将交易与当前的哈希值 $H_i$ 进行绑定，交易被记录为 $(H_i, ~T)$，其中 $H_i$ 是该交易的时间戳，$T$ 是交易内容。  
比如：  
假设一个交易 $T_1$ 在 $ H_100 $ 计算时被接收，那么它被记录为 $(H_{100}, ~T_1)$   
假设一个交易 $T_2$ 在 $ H_200 $ 计算时被接收，那么它被记录为 $(H_{200}, ~T_2)$  

可以看到，由于 PoH 的计算是实时进行的，不间断的，但是交易的接收是随机的，可能有些时刻没有任何交易到达。因此会有某些 $ H_i $ 没有绑定的交易，这些无交易绑定的 $ H_i $ 可以看作是“空时间点”。  
当节点打包区块时，只会打包绑定了交易的 $ H_i $，而未绑定交易的 $ H_i $ 可能会被跳过，不影响区块的最终内容。  
未绑定交易的 $ H_i $ 被“跳过”并不会导致信息丢失或时间序列断层，因为 PoH 的主要设计目标是记录事件的时间顺序，而不是完整记录所有的中间哈希值。  
比如：  
时间序列为：$ H_0 - H_1 - H_2 - H_3 - H_4 - H_5 - ... $  
只有 $ H_1 $ 和 $ H_3 $ 绑定了交易 $ T_1 $ 和 $ T_2 $，那么区块中只会记录 $(H_{1}, ~T_1)$ 和 $(H_{3}, ~T_2)$，而 $ H_2, ~ H_4, ~ H_5 $ 等未绑定交易的哈希值不会记录到区块中。  

### 领导者节点
在 Solana 的架构中，交易 $T$ 是由 领导者节点（Leader Node） 绑定到 $H_i$ 上的。  
领导者节点将绑定了交易的 $H_i$ 和对应的交易 $T$ 一起打包，形成一个区块。  
在 Solana 的 Tower BFT 共识机制下，网络中每个节点会按一定顺序轮流充当 领导者节点。当前的领导者节点负责生成 PoH 链、接收交易、并将交易绑定到哈希值 $H_i$，最终打包形成区块广播到区块连网络中  

其他节点的作用  
其他节点（验证者节点）会验证领导者节点生成的区块是否符合 PoH 链的规则。  
验证 $H_i$ 是否符合连续的哈希运算规则。  
验证交易 $T$ 是否有效，并确保 $T$ 绑定到正确的 $H_i$ 。

为什么由领导者绑定？  
1. 高效处理交易：PoH 的生成和交易绑定在一个节点中完成，避免了多节点通信的延迟。  
2. 确保时间顺序：PoH 链生成是单线程的、连续的，由领导者节点负责，可确保所有绑定交易的时间戳有序。  
3. 减少冲突：只有领导者节点负责绑定，避免了多个节点同时处理交易导致的竞争或重复绑定问题。

领导者生成 PoH 链时 $H_0$ 的确定方法  
1. 领导者生成 PoH 链时，初始值 $H_0$ 通常取自 上一个区块的 PoH 链的末尾值。这是为了确保整个网络中的 PoH 链具有连续性和可验证性。
2. 对于 Solana 网络的创世区块（Genesis Block），因为没有上一区块，其 $H_0$ 是由网络的创世参数决定的
